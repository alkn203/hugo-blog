<!DOCTYPE html>
<html lang="ja">

<head>
  
  <meta charset="UTF-8">
  <title>
    【phina.js】Mapクラスを作ってみた | Keep On Coding
  </title>
  
  <meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1">
  
  <meta name="twitter:card" content="summary" />
  <meta name="og:title" content="【phina.js】Mapクラスを作ってみた" />
  <meta name="og:description" content="はじめに RPGなどで固定マップで単純な当たり判定を行いたい時は、Mapデータと当たり判定データを読み込んで行う方法が便利です。 今回は、enchant.jsにあったMapクラスを参考にphina.js版を作ってみました。
コンストラクタ var map = phina.util.Map({ tileWidth: 64, tileHeight: 64, imageName: &#39;tile&#39;, mapData: data, collisionData: collision, }).addChildTo(this); プロパティ    プロパティ 説明     tileWidth タイルの幅   tileHeight タイルの高さ   imageName タイルセット画像の名前   mapData マップデータの2次元配列   collisionData タイル衝突判定用の2次元配列    メンバ関数    関数 説明     hitTest マップとの衝突判定を行う(座標から)   hitTestByIndex マップとの衝突判定を行う(インデックスから)   checkTile タイルが何か調べる(座標から)   checkTileByIndex タイルが何か調べる(インデックスから)   setTile タイルを更新する   getChild 子要素を得る（座標から）   getChildByIndex 子要素を得る（インデックスから）    おわりに 本格的なマップ作成には、タイルマップエディタが必要になってくると思いますが、簡単なゲームであれば、この程度の機能でも使えるのではないでしょうか。" />
  <meta name="og:image" content="https://alkn203.github.io/blog/2020/01/03/phina-map-class/map.png" />
  <meta name="twitter:url" content="https://alkn203.github.io/blog/2020/01/03/phina-map-class/" />
  <meta name="twitter:site" content="@alkn203" />
  <meta name="twitter:creator" content="@alkn203" />
  
  <link rel="canonical" href="https://alkn203.github.io/blog/2020/01/03/phina-map-class/" />
  
  
  <link rel="stylesheet" href="https://alkn203.github.io/blog/css/mobile.css" media="screen and (max-width: 750px)">
  <link rel="stylesheet" href="https://alkn203.github.io/blog/css/theme.css" media="screen and (min-width: 750px)">
  <link rel="stylesheet" href="https://alkn203.github.io/blog/css/syntax.css">
</head>

<body>
  <div class="container">
    
    <header role="banner" class="header">
      <div class="header-title">
  <h1><a href="https://alkn203.github.io/blog/">Keep On Coding</a></h1>
</div>
<div class="header-subtitle">
  Tips and tutorials about phina.js
</div>
<div class="header-menu">
  <ul>
    <li><a href="https://phinajs.com/">phina.js(Offcial)</a></li>
    <li><a href="https://github.com/phinajs/phina.js">phina.js(GitHub)</a></li>
    <li><a href="https://qiita.com/alkn203/items/bca3222f6b409382fe20">phina.js Tips(Qiita)</a></li>
    <li><a href="#">About this site</a></li>
  </ul>
</div>
<div class="header-profile">
  <div class="header-profile-image">
    
    <img src="https://www.gravatar.com/avatar/ccebfc0792db78ae374d6557d3462ef2">
  </div>
  <div class="header-profile-author">
    <a href="https://twitter.com/alkn203">alkn203</a>
  </div>
</div>
    </header>
    
    <nav class="sidebar">
      <h1>Sections</h1>


  <ul>
      <li><a href="https://alkn203.github.io/blog/tips/">Tips</a>
  <ul>
  </ul>
      </li>
      <li><a href="https://alkn203.github.io/blog/tutorials/">Tutorials</a>
  <ul>
      <li><a href="https://alkn203.github.io/blog/tutorials/breakout/">Breakout</a>
  <ul>
  </ul>
      </li>
      <li><a href="https://alkn203.github.io/blog/tutorials/2dshooting/">Shooting</a>
  <ul>
  </ul>
      </li>
  </ul>
      </li>
      <li><a href="https://alkn203.github.io/blog/others/">Others</a>
  <ul>
  </ul>
      </li>
      <li><a href="https://alkn203.github.io/blog/works/">Works</a>
  <ul>
  </ul>
      </li>
  </ul>
    </nav>
    
    <main role="main" class="main">
      
  <div class="single-container">
    <div class="single-title">
      <h1>【phina.js】Mapクラスを作ってみた</h1>
    </div>
    <div class="single-modified">
      2020-2-25  
    </div>
    <div class="single-content">
      
      <h2 id="はじめに">はじめに</h2>
<p><strong>RPG</strong>などで固定マップで単純な当たり判定を行いたい時は、<strong>Map</strong>データと当たり判定データを読み込んで行う方法が便利です。
今回は、<strong>enchant.js</strong>にあった<strong>Map</strong>クラスを参考に<strong>phina.js</strong>版を作ってみました。</p>
<p><img src="map.png" alt="map.png"></p>
<h2 id="コンストラクタ">コンストラクタ</h2>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">phina</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
  <span class="nx">tileWidth</span><span class="o">:</span> <span class="mi">64</span><span class="p">,</span>
  <span class="nx">tileHeight</span><span class="o">:</span> <span class="mi">64</span><span class="p">,</span>
  <span class="nx">imageName</span><span class="o">:</span> <span class="s1">&#39;tile&#39;</span><span class="p">,</span>
  <span class="nx">mapData</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
  <span class="nx">collisionData</span><span class="o">:</span> <span class="nx">collision</span><span class="p">,</span>
<span class="p">}).</span><span class="nx">addChildTo</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</code></pre></div><h2 id="プロパティ">プロパティ</h2>
<table>
<thead>
<tr>
<th align="left">プロパティ</th>
<th align="left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">tileWidth</td>
<td align="left">タイルの幅</td>
</tr>
<tr>
<td align="left">tileHeight</td>
<td align="left">タイルの高さ</td>
</tr>
<tr>
<td align="left">imageName</td>
<td align="left">タイルセット画像の名前</td>
</tr>
<tr>
<td align="left">mapData</td>
<td align="left">マップデータの2次元配列</td>
</tr>
<tr>
<td align="left">collisionData</td>
<td align="left">タイル衝突判定用の2次元配列</td>
</tr>
</tbody>
</table>
<h2 id="メンバ関数">メンバ関数</h2>
<table>
<thead>
<tr>
<th align="left">関数</th>
<th align="left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">hitTest</td>
<td align="left">マップとの衝突判定を行う(座標から)</td>
</tr>
<tr>
<td align="left">hitTestByIndex</td>
<td align="left">マップとの衝突判定を行う(インデックスから)</td>
</tr>
<tr>
<td align="left">checkTile</td>
<td align="left">タイルが何か調べる(座標から)</td>
</tr>
<tr>
<td align="left">checkTileByIndex</td>
<td align="left">タイルが何か調べる(インデックスから)</td>
</tr>
<tr>
<td align="left">setTile</td>
<td align="left">タイルを更新する</td>
</tr>
<tr>
<td align="left">getChild</td>
<td align="left">子要素を得る（座標から）</td>
</tr>
<tr>
<td align="left">getChildByIndex</td>
<td align="left">子要素を得る（インデックスから）</td>
</tr>
</tbody>
</table>
<h2 id="おわりに">おわりに</h2>
<p>本格的なマップ作成には、タイルマップエディタが必要になってくると思いますが、簡単なゲームであれば、この程度の機能でも使えるのではないでしょうか。</p>
<ul>
<li><a href="https://runstant.com/alkn203/projects/05d8a818">サンプルコード(runstant)</a></li>
<li><a href="https://github.com/alkn203/phina-extensions/blob/master/util/map.js">ソースコード(Github)</a></li>
</ul>

    </div>
  </div>

    </main>
    
    <nav class="page">
      
  <div class="prevnext-container">
  
    <div class="prev-arrow"></div>
    <div class="prev-text"><a href="https://alkn203.github.io/blog/2019/12/31/phina-each-extension/">【phina.js】Arrayクラスのeach関数を拡張する</a></div>
  
  
    <div class="next-text"><a href="https://alkn203.github.io/blog/2020/02/25/phina-fill/">【phina.js】塗りつぶしアルゴリズムとtweenerを組み合わせた表現</a></div>
    <div class="next-arrow"></div>
  
</div>

    </nav>
    
    <nav class="tocbar">
      
  
  
    <h1>Table of contents</h1>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#はじめに">はじめに</a></li>
    <li><a href="#コンストラクタ">コンストラクタ</a></li>
    <li><a href="#プロパティ">プロパティ</a></li>
    <li><a href="#メンバ関数">メンバ関数</a></li>
    <li><a href="#おわりに">おわりに</a></li>
  </ul>
</nav>
  

    </nav>
    
    <footer role="contentinfo" class="footer">
      <div class="copyright">
  ©&nbsp2020&nbsp<a href="https://twitter.com/alkn203">alkn203</a>
</div>
    </footer>
  </div>
  
  
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-145323973-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>

</html>